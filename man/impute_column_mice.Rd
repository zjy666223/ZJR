% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/impute_column_mice.R
\name{impute_column_mice}
\alias{impute_column_mice}
\title{多重插补（mice 封装）}
\usage{
impute_column_mice(
  data,
  colname,
  m = 5,
  maxit = 10,
  seed = 123,
  predictors = NULL,
  method = NULL,
  combine = c("first", "mean", "mode"),
  keep_indicator = TRUE
)
}
\arguments{
\item{data}{data.frame/tibble。}

\item{colname}{需要插补的列名（字符串）。}

\item{m}{插补次数（mice 的 m），默认 5。}

\item{maxit}{迭代次数，默认 10。}

\item{seed}{随机种子，默认 123。}

\item{predictors}{作为预测变量的列名字符向量；默认 \code{NULL} 表示使用除目标列外的所有列。}

\item{method}{可指定 mice 方法（针对目标列）；\code{NULL} 表示自动：
\itemize{
\item numeric/integer → "pmm"；
\item 二分类/逻辑 → "logreg"；
\item 多分类(≥3) → "polyreg"。
}}

\item{combine}{合并方式："first"（默认，返回第1套完成数据）；
"mean"（数值取均值、整数取四舍五入、分类取众数）；
"mode"（所有类型取众数；数值并列取平均）。}

\item{keep_indicator}{是否保留插补指示列 \verb{<col>_was_na}，默认 TRUE。}
}
\value{
list：
\itemize{
\item data：完成插补的数据框；
\item mids：mice 的 mids 对象；
\item used_method：实际使用的方法；
\item combine：合并策略；
\item predictors：使用的预测变量列名。
}
}
\description{
只对指定列进行多重插补，其他列保持原样作为预测变量使用。自动识别列类型并选择合适的
\code{mice} 方法（数值→\code{pmm}，二分类/逻辑→\code{logreg}，多分类→\code{polyreg}）。支持选择合并策略：
返回第1套、均值/众数等。
}
\examples{
# 对数值列 x 插补，只插补 x，其他列作为预测变量
res <- impute_column_mice(d, "x", m = 5, combine = "mean")
d_imp <- res$data
res2 <- impute_column_mice(d, "BMI_cat", m = 10, combine = "mode")
d_imp <- res2$data
1
\dontrun{
library(ZJR)
set.seed(1)
d <- data.frame(x = rnorm(100), y = sample(c("A","B","C"), 100, TRUE), z = rbinom(100,1,0.5))
d$x[sample(100, 40)] <- NA
res <- impute_column_mice(d, "x", m = 5, combine = "mean")
head(res$data)
}
}
